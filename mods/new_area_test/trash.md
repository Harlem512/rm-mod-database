```sp
-- global.__test_room = room_add()
-- global.__test_room = room_duplicate(rm_grass_test)
global.__test_room = room_duplicate(rm_large_test)

-- small room
-- room_set_width(global.__test_room, 444)
-- room_set_height(global.__test_room, 250)

-- big room
-- room_set_width(global.__test_room, 1000)
-- room_set_height(global.__test_room, 600)
```

# controller

## create

```sp
global.__na_test_init = false
-- recreate ogame
-- let game = instance_find(ogame)
-- with game {
--   instance_change(omod_instance, false)
-- }
-- let dupe = instance_copy(game, false)
-- instance_destroy(game, false)
-- with dupe {
--   instance_change(ogame, false)
-- }
```

## room_start

```sp
match room_get() {
  case rm_start_0 {
    if !global.__na_test_init {
      global.map_data_[global.__test_room] = [{
        "xx": 1,
        "yy": 1,
        "color": 2,
        "angle": 0,
        "extra": false,
        "index": 0,
        "rom": global.__test_room,
        "found": false,
      }]
      ds_grid_set(global.map_grid_, 1, 1, global.__test_room)
    }

    global.__c = room_get_camera(room_get(), 0)

    -- delay init
    alarm_set(0, 3)
  }
  case global.__test_room2 {
    let l1 = layer_create(-100, "Tiles_1")
    -- let t1 = layer_tilemap_create(l1, 0, 0, 1, 28, 16)
    let t1 = layer_tilemap_create(l1, 0,0, 1, 63,38)
    -- let t1 = layer_tilemap_get_id("Tiles_1")
    global.tilemap_load(t1, [ [ 328,328,328,328,328,328,328,328,328,193,193,328,328,328,199,231 ],[ 328,328,328,328,328,328,328,328,328,328,328,193,328,193,200,232 ],[ 328,328,328,328,333,329,41,329,41,41,329,335,328,193,328,328 ],[ 385,385,385,385,332,0,0,0,0,0,0,325,328,193,328,328 ],[ 0,0,0,97,0,0,0,0,0,0,0,5,8,8,328,328 ],[ 0,0,0,97,0,0,0,0,0,0,0,5,8,8,328,328 ],[ 385,385,385,97,0,0,0,0,0,0,0,6,329,335,328,328 ],[ 0,0,0,0,0,0,0,0,0,0,0,0,0,325,8,328 ],[ 0,0,0,0,0,0,0,0,0,0,0,0,0,325,8,328 ],[ 0,0,0,0,0,0,0,0,0,0,0,0,0,325,8,328 ],[ 0,0,0,0,0,0,0,0,0,0,0,0,0,325,8,328 ],[ 0,0,0,0,0,0,0,0,0,0,0,0,0,5,385,328 ],[ 0,0,0,0,0,0,0,0,0,0,0,0,0,5,385,328 ],[ 0,0,0,0,0,0,0,0,0,0,0,0,0,5,8,328 ],[ 0,0,0,0,0,0,0,0,0,0,0,0,0,5,8,328 ],[ 0,0,0,0,0,0,0,0,0,0,0,0,0,325,8,328 ],[ 0,0,0,0,0,0,0,0,0,0,0,0,0,325,8,328 ],[ 0,0,0,0,0,0,0,0,0,0,0,0,0,325,8,328 ],[ 0,0,0,0,0,0,0,0,0,0,0,0,324,336,8,328 ],[ 0,0,0,0,0,0,0,0,0,0,0,0,391,423,328,328 ],[ 0,0,0,0,0,0,0,0,0,0,0,0,392,424,328,328 ],[ 0,0,0,0,0,0,0,0,0,385,327,327,193,328,8,328 ],[ 0,0,0,0,0,0,0,0,0,385,193,328,328,328,328,328 ],[ 0,0,0,0,0,0,0,0,0,385,328,328,193,193,328,328 ],[ 0,0,0,0,0,0,0,324,327,336,328,328,193,193,328,328 ],[ 0,0,0,0,0,0,0,325,385,193,193,328,328,328,328,328 ],[ 0,0,0,0,0,324,327,328,328,328,328,328,328,328,328,328 ],[ 0,0,0,0,0,385,385,328,328,328,328,328,328,328,328,328 ] ])

    -- let l2 = layer_create(200, "Tiles_2")
    let l2 = layer_create(200, "jh")
    -- let t2 = layer_tilemap_create(l2, 0, 0, 1, 28, 16)
    let t2 = layer_tilemap_create(l2, 0,0, 1, 63,38)
    -- let t2 = layer_tilemap_get_id("Tiles_2")
    global.tilemap_load(t2,
    [ [ 0,0,72,75,0,0,0,0,0,0,0,0,0,0,0,0 ],[ 0,0,72,78,74,68,71,74,68,71,71,74,0,0,0,0 ],[ 0,69,80,72,75,72,72,78,80,72,72,75,0,0,0,0 ],[ 71,80,72,72,78,65,73,193,193,72,72,78,71,0,0,0 ],[ 72,72,72,72,72,75,0,344,193,79,193,72,75,0,0,0 ],[ 72,72,72,77,73,76,0,343,0,70,79,193,75,0,0,0 ],[ 72,72,77,76,0,0,0,0,0,68,80,193,78,72,0,0 ],[ 73,73,76,0,0,0,0,0,68,80,72,193,78,72,0,0 ],[ 0,0,0,0,0,0,0,0,69,72,72,193,193,72,0,0 ],[ 0,0,0,0,0,0,0,344,193,193,193,193,193,72,0,0 ],[ 0,0,0,0,0,0,0,0,308,193,193,193,193,193,0,0 ],[ 0,0,0,0,0,0,0,0,0,70,79,193,193,72,0,0 ],[ 0,0,0,0,0,0,0,0,0,0,193,72,72,72,0,0 ],[ 0,0,0,0,0,0,0,0,0,68,80,72,72,72,0,0 ],[ 0,0,0,0,0,0,0,0,0,193,72,72,72,72,0,0 ],[ 0,0,0,0,0,0,0,0,0,69,72,72,193,72,0,0 ],[ 0,0,0,0,0,0,0,0,0,70,79,72,193,72,0,0 ],[ 0,0,0,0,0,0,0,0,313,345,193,72,193,72,0,0 ],[ 0,0,0,0,0,0,0,0,314,346,193,72,193,72,0,0 ],[ 0,0,0,0,0,0,0,0,0,68,80,72,193,72,0,0 ],[ 0,0,0,0,0,0,0,68,71,80,193,193,193,0,0,0 ],[ 0,0,0,0,0,193,71,80,72,72,72,72,72,72,0,0 ],[ 0,0,0,0,0,69,193,72,193,193,72,72,72,72,0,0 ],[ 0,0,0,0,0,199,231,72,72,72,72,77,73,0,0,0 ],[ 0,0,0,0,0,200,232,72,72,72,77,75,0,0,0,0 ],[ 0,0,0,0,68,80,72,72,79,72,72,0,0,0,0,0 ],[ 0,0,0,0,69,72,77,0,70,79,72,0,0,0,0,0 ],[ 0,0,0,0,193,193,75,0,0,70,72,0,0,0,0,0 ] ])

    -- let l3 = layer_create(0, "TS1")
    -- let t3 = layer_tilemap_create(l3, 0, 0, 1, 28, 16)
    -- global.tilemap_load(t3, [ [ 0,0,69,72,75,75,0,0,0,0,0,0,0,0,0,0 ],[ 0,0,69,72,0,0,0,0,0,0,0,0,74,74,0,0 ],[ 269,290,289,73,0,68,71,71,71,74,74,0,75,0,0,0 ],[ 289,290,289,0,0,69,72,72,72,78,74,0,78,71,71,0 ],[ 205,257,237,0,0,193,193,72,72,72,75,0,72,72,0,0 ],[ 0,0,0,344,313,345,193,72,72,72,75,0,72,72,0,0 ],[ 0,0,0,343,0,0,70,79,72,72,75,74,72,72,0,0 ],[ 0,0,0,0,281,314,346,193,193,72,77,0,72,72,0,0 ],[ 0,0,0,0,282,313,345,193,193,72,78,80,72,72,0,0 ],[ 0,0,0,0,0,0,0,0,70,79,72,72,77,73,0,0 ],[ 0,0,0,0,0,0,205,193,193,193,193,79,75,0,0,0 ],[ 0,0,0,0,0,0,237,193,193,193,193,193,76,0,0,0 ],[ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 ],[ 0,0,0,0,0,0,0,0,0,0,0,71,71,71,0,0 ],[ 0,0,0,0,0,0,0,0,0,0,0,72,72,0,0,0 ],[ 0,0,0,0,0,0,193,225,225,193,193,193,73,0,0,0 ],[ 0,0,0,0,0,0,0,0,0,0,0,78,71,0,0,0 ],[ 0,0,0,0,0,0,0,0,0,0,193,72,72,0,0,0 ],[ 0,0,193,0,0,193,289,289,289,289,0,72,72,0,0,0 ],[ 0,0,344,343,0,289,289,289,289,289,289,72,72,0,0,0 ],[ 0,0,0,344,313,345,0,225,225,72,75,0,72,72,0,0 ],[ 0,0,0,0,314,346,193,193,69,72,75,0,72,72,0,0 ],[ 0,0,0,0,315,347,193,193,69,72,72,0,72,72,0,0 ],[ 0,0,225,225,225,225,193,68,80,72,72,0,77,73,0,0 ],[ 0,345,346,0,193,193,193,69,72,72,72,0,75,0,0,0 ],[ 0,346,193,193,193,193,0,69,72,72,72,0,0,0,0,0 ],[ 0,314,346,193,193,0,0,69,72,72,72,0,0,0,0,0 ],[ 346,313,345,193,193,0,0,69,72,72,72,0,0,0,0,0 ] ])
    global.rebuild_cameras(room_get())
  }
}

global.rmml.log(room_get_camera(room_get(), 0))
global.rmml.log(room_get_camera(room_get(), 1))
global.rmml.log(room_get_camera(room_get(), 2))
global.rmml.log(room_get_camera(room_get(), 3))
global.rmml.log(room_get_camera(room_get(), 4))
global.rmml.log(room_get_camera(room_get(), 5))
global.rmml.log(room_get_camera(room_get(), 6))
global.rmml.log(room_get_camera(room_get(), 7))

global.dump_layers()
```

<!-- Modify room transitions -->
## alarm_0

```sp
match room_get() {
  case rm_start_0 {
    with oroom_transition {
      global.rmml.log([self.cx, self.cy])
      self.cx = 0
      self.cy = 0
      self.target_room = global.__test_room
    }
  }
}
global.dump_layers()
```

## draw_gui_end

```sp
global.deb_logger.append([room_get(), room_width_get(), room_height_get()], "room data")

global.deb_logger.append([global.mousex, global.mousey], "mousex")
global.deb_logger.append([global.mouse_gui_x_, global.mouse_gui_y_], "mouse_gui_x_")
global.deb_logger.append([device_mouse_x_to_gui(0), device_mouse_y_to_gui(0)])
global.deb_logger.append([display_get_gui_width(), display_get_gui_height()], "gui size")

with oplayer {
  global.deb_logger.append([self.x, self.y], "plr")
}
```
